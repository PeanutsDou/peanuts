# 游戏内位置与场景变量分析报告

通过分析 `example/pos` (JSON格式) 以及结合常见的游戏Bug反馈数据结构，我们提取了以下与“游戏内位置”、“场景”以及“坐标”密切相关的关键变量。

这些变量在区分“同一类Bug是否发生在不同地点”时起着决定性作用。例如，“模型悬空”是一个通用现象，但“主城广场的雕像悬空”与“副本入口的石头悬空”是两个完全不同的Bug条目。

## 核心位置变量

以下变量直接定义了玩家或Bug发生时的空间位置：

### 1. `scene` (场景ID)
*   **类型**: Integer (例如: `219`)
*   **含义**: 当前所在的游戏场景/地图的唯一标识符。
*   **作用**: 最顶层的空间区分。不同的 `scene` ID 意味着完全不同的地图（如：主城、野外地图A、副本B）。
*   **分析价值**: **极高**。这是区分Bug地点的首要维度。

### 2. `pos` / `client_position` / `model_position` (坐标)
*   **类型**: Array [x, y, z] (例如: `[-198.26, 146.28, -45.52]`)
*   **含义**: 玩家或实体在当前场景中的精确三维坐标。
*   **作用**: 在同一个 `scene` 中，进一步精确定位Bug发生点。
*   **分析价值**: **极高**。
    *   即使是同一个 `scene`，坐标相距较远通常意味着不同的Bug实例（例如：地图左上角的卡点 vs 地图右下角的卡点）。
    *   在聚类分析时，可以设定一个距离阈值（例如 5米 或 10米），将坐标相近的同类反馈视为同一个Bug。

### 3. `lst_space_infos` (历史场景信息)
*   **类型**: String (Array representation)
*   **含义**: 记录了玩家最近经过的场景序列及时间戳。
    *   格式示例: `'19:49:40_aUFHUk4MMCP8OGqh_219'` (时间_EntityID_SceneID)
*   **作用**: 辅助判断Bug是否与场景切换、加载有关。

### 4. `mini_map` (小地图信息)
*   **类型**: Object
*   **关键子字段**:
    *   `maps`: 当前加载的小地图资源路径 (如 `ui/bigmap/pve35.png`)。
    *   `pos`: 小地图上的映射坐标。
*   **作用**: 提供了可视化的位置参考，有时玩家描述会说“在小地图PVE35区域”。

## 辅助环境变量

以下变量描述了环境状态，有助于进一步区分特定条件下的Bug：

### 1. `weather` (天气)
*   **类型**: String (例如: `Current: weather/bigworld/weather_sm_bg24_v20.xml`)
*   **含义**: 当前场景的天气系统配置。
*   **作用**: 某些图形渲染Bug（如“地面反光异常”、“雨天掉帧”）只在特定天气下触发。

### 2. `light_type` / `time_in_a_day` (光照/时间)
*   **含义**: 游戏内的时间或光照模式（白天/黑夜）。
*   **作用**: 区分与光照渲染相关的Bug。

### 3. `trace_infos` / `current_trace_mission` (任务追踪)
*   **含义**: 当前正在进行的任务。
*   **作用**: 很多Bug是任务流程卡死。如果 `scene` 相同但 `current_trace_mission` 不同，可能指向该场景下不同任务线的Bug。

## 建议的去重/聚类策略

为了精准区分“同类Bug但不同地点”，建议在数据预处理或AI分析阶段，显式引入以下逻辑：

1.  **一级分类**: `scene` (场景ID)。不同场景的反馈强制视为不同Bug。
2.  **二级聚类**: `pos` (坐标)。
    *   计算两个反馈的欧几里得距离。
    *   如果距离 < 阈值（如 10.0），且Bug描述语义高度相似，则视为重复。
    *   如果距离 > 阈值，即使描述都是“石头悬空”，也应视为两个独立的Bug条目（需分别修复）。
3.  **语义辅助**:
    *   提取玩家描述中的地名关键词（如“墨洛维城堡”、“大桥下”、“出生点”）。
    *   结合 `scene` ID 进行交叉验证。

## 总结提取

在进行 Bug 去重分析时，除了文本语义外，**必须** 结合以下结构化数据（如果可用）：

| 变量名 | 关键性 | 用途 |
| :--- | :--- | :--- |
| **scene** | ⭐⭐⭐⭐⭐ | 区分大地图/副本 |
| **pos** (x,y,z) | ⭐⭐⭐⭐⭐ | 区分同一地图内的具体位置 |
| **weather** | ⭐⭐⭐ | 区分特定环境下的渲染问题 |
| **current_trace_mission** | ⭐⭐⭐ | 区分特定任务流程问题 |
